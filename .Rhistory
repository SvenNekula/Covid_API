#Loading packages
library(httr)
library(jsonlite)
#API request
dt <- GET("https://services7.arcgis.com/mOBPykOjAyBO2ZKk/arcgis/rest/services/Coronaf%C3%A4lle_in_den_Bundesl%C3%A4ndern/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json")
dt
rawToChar(dt)
rawToChar(dt$content)
#creating DF
datCov <- fromJSON(rawToChar(dt$content))
names(datCov)
View(datCov)
View(datCov)
head(datCov$fields)
head(datCov$features)
test <- datCov$features
View(test)
dfCov19 <- datCov$features
dfCov19[[1]]
listCov19 <- datCov$features
dfCov19 <- as.data.frame(listCov19[[1]])
dim(dfCov19)
head(dfCov19)
#Using the data; Creating interactive map:
install.packages("leaflet")
head(dfCov19)
#Using the data; Creating interactive map:
install.packages("leaflet")
library(leaflet)
mymap <- leaflet() %>%
addTiles()
View(mymap)
mymap
mymap <- leaflet() %>%
addTiles() %>%
addPolygons(data=dfCov19)
mymap <- leaflet() %>%
addTiles() %>%
addPolygons(data=dfCov19)
mymap <- leaflet() %>%
addTiles() %>%
addPolygons(data=listCov19)
mymap <- leaflet() %>%
addTiles() %>%
addPolygons(data=listCov19)
View(dfCov19)
library(ggplot2)
map <- ggplot() + geom_polygon(data = dfCov19, aes(x = dfCov19$Shape__Area, y = dfCov19$Shape__Area, group = group), colour = "black", fill = NA)
map
map <- ggplot() + geom_polygon(data = dfCov19, aes(x = dfCov19$Shape__Area, y = dfCov19$Shape__Area), colour = "black", fill = NA)
map
#Using the data
barplot(table(dfCov19$cases7_bl_per_100k))
hist(v38_sozd_kgroe, freq=F)    # Histogramm
#Using the data
sapply(dfCov19, class)
attach(dfCov19)
hist(cases7_bl_per_100k)
hist(cases7_bl_per_100k, freq = F)
hist(cases7_bl_per_100k, freq = T)
barplot(table(cases7_bl_per_100k))
library(ggplot2)
View(dfCov19)
case_plot <- geom_bar(aes(LAN_ew_GEN, cases7_bl_per_100k))
case_plot
case_plot
plot(LAN_ew_GEN, cases7_bl_per_100k)
g <- ggplot(LAN_ew_GEN, aes(cases7_bl_per_100k)) + geom_bar(stat = "identity")
library(ggplot2)
g <- ggplot(LAN_ew_GEN, aes(cases7_bl_per_100k)) + geom_bar(stat = "identity")
g <- ggplot(dfCov19, aes(LAN_ew_GEN, cases7_bl_per_100k)) + geom_bar(stat = "identity")
g
dfc <- dfCov19
levels(dfc$LAN_ew_GEN)
levels(dfc$LAN_ew_EWZ)
View(dfCov19)
dfc$LAN_ew_GEN
dfc$LAN_ew_GEN <- c("SH", "HH", "NI", "HB", "NW", "HE", "RP", "BW",
"BY", "SL","BE", "BB", "MV", "SN", "ST", "TH")
dfc$LAN_ew_GEN
dfc
View(dfCov19)
View(dfc)
g <- ggplot(dfc, aes(LAN_ew_GEN, cases7_bl_per_100k)) + geom_bar(stat="identity")
g
g <- ggplot(dfc, aes(LAN_ew_GEN, cases7_bl_per_100k)) + geom_bar(stat="identity")
library(ggplot2)
g <- ggplot(dfc, aes(LAN_ew_GEN, cases7_bl_per_100k)) + geom_bar(stat="identity")
g
#Loading packages
library(httr)
library(jsonlite)
#API request
dt <- GET("https://services7.arcgis.com/mOBPykOjAyBO2ZKk/arcgis/rest/services/Coronaf%C3%A4lle_in_den_Bundesl%C3%A4ndern/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json")
#creating DF
datCov <- fromJSON(rawToChar(dt$content))
listCov19 <- datCov$features
dfCov19 <- as.data.frame(listCov19[[1]])
dim(dfCov19)
head(dfCov19)
#Using the data
sapply(dfCov19, class)
attach(dfCov19)
dfc <- dfCov19
dfc$LAN_ew_GEN
dfc$LAN_ew_GEN <- c("SH", "HH", "NI", "HB", "NW", "HE", "RP", "BW",
"BY", "SL","BE", "BB", "MV", "SN", "ST", "TH")
#Using the data
sapply(dfCov19, class)
dfc <- dfCov19
dfc$LAN_ew_GEN
dfc$LAN_ew_GEN <- c("SH", "HH", "NI", "HB", "NW", "HE", "RP", "BW",
"BY", "SL","BE", "BB", "MV", "SN", "ST", "TH")
dfc$LAN_ew_GEN
library(ggplot2)
g <- ggplot(dfc, aes(LAN_ew_GEN, cases7_bl_per_100k)) + geom_bar(stat="identity")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity")
g
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Deutschland") + xlab("Bundesland (AbkÃ¼rzung)") +
ylab("Faelle pro 100.000 Einwohner")
g
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("Cases per 100.000 inhabitants")
g
View(dfc)
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days")
g
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
g
library(ggplot2)
par(mfrow(c(1,2)))
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
par(mfrow=(c(1,2)))
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("Total cases")
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("Total cases")
par(mfrow=(c(1,2)))
g
g1
par(mfrow=(c(1,2)))
g
g1
layout(1)
install.packages("cowplot")
library(cowplot)
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") + xlab("State (short)") +
ylab("Total cases")
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases")
plot_grid(g, g1, labels="")
range(dfc$Fallzahl)
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases") + ylim(15500, 485000)
plot_grid(g, g1, labels="")
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases")
plot_grid(g, g1, labels="")
human_numbers <- function(x = NULL, smbl ="", signif = 1){
humanity <- function(y){
if (!is.na(y)){
tn <- round(abs(y) / 1e12, signif)
b <- round(abs(y) / 1e9, signif)
m <- round(abs(y) / 1e6, signif)
k <- round(abs(y) / 1e3, signif)
if ( y >= 0 ){
y_is_positive <- ""
} else {
y_is_positive <- "-"
}
if ( k < 1 ) {
paste0( y_is_positive, smbl, round(abs(y), signif ))
} else if ( m < 1){
paste0 (y_is_positive, smbl,  k , "k")
} else if (b < 1){
paste0 (y_is_positive, smbl, m ,"m")
}else if(tn < 1){
paste0 (y_is_positive, smbl, b ,"bn")
} else {
paste0 (y_is_positive, smbl,  comma(tn), "tn")
}
} else if (is.na(y) | is.null(y)){
"-"
}
}
sapply(x,humanity)
}
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases") +
scale_y_continuous(labels = human_gbp)
g1 <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases") +
scale_y_continuous(labels = human_numbers)
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity",fill =..count..) +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k, fill=..count..)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)") +
scale_fill_gradient2()
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)") +
scale_fill_gradient2(low="yellow", mid="orange", high="red")
plot_grid(g, g1, labels="")
g <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)") +
scale_fill_gradient2(low="yellow", mid="orange", high="red", space = "Lab")
g
cp100k <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)") +
human_numbers <- function(x = NULL, smbl ="", signif = 1){
humanity <- function(y){
if (!is.na(y)){
tn <- round(abs(y) / 1e12, signif)
b <- round(abs(y) / 1e9, signif)
m <- round(abs(y) / 1e6, signif)
k <- round(abs(y) / 1e3, signif)
if ( y >= 0 ){
y_is_positive <- ""
} else {
y_is_positive <- "-"
}
if ( k < 1 ) {
paste0( y_is_positive, smbl, round(abs(y), signif ))
} else if ( m < 1){
paste0 (y_is_positive, smbl,  k , "k")
} else if (b < 1){
paste0 (y_is_positive, smbl, m ,"m")
}else if(tn < 1){
paste0 (y_is_positive, smbl, b ,"bn")
} else {
paste0 (y_is_positive, smbl,  comma(tn), "tn")
}
} else if (is.na(y) | is.null(y)){
"-"
}
}
sapply(x,humanity)
}
ct <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases") +
scale_y_continuous(labels = human_numbers)
plot_grid(cp100k, ct, labels="")
cp100k <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
cp100k <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -cases7_bl_per_100k),
cases7_bl_per_100k)) + geom_bar(stat="identity") +
ggtitle("Covid-19 in Germany") + xlab("State (short)") +
ylab("new cases per 100.000 inhabitants (7 days)")
human_numbers <- function(x = NULL, smbl ="", signif = 1){
humanity <- function(y){
if (!is.na(y)){
tn <- round(abs(y) / 1e12, signif)
b <- round(abs(y) / 1e9, signif)
m <- round(abs(y) / 1e6, signif)
k <- round(abs(y) / 1e3, signif)
if ( y >= 0 ){
y_is_positive <- ""
} else {
y_is_positive <- "-"
}
if ( k < 1 ) {
paste0( y_is_positive, smbl, round(abs(y), signif ))
} else if ( m < 1){
paste0 (y_is_positive, smbl,  k , "k")
} else if (b < 1){
paste0 (y_is_positive, smbl, m ,"m")
}else if(tn < 1){
paste0 (y_is_positive, smbl, b ,"bn")
} else {
paste0 (y_is_positive, smbl,  comma(tn), "tn")
}
} else if (is.na(y) | is.null(y)){
"-"
}
}
sapply(x,humanity)
}
ct <- ggplot(dfc, aes(reorder(LAN_ew_GEN, -Fallzahl),
Fallzahl)) + geom_bar(stat="identity") +
ggtitle("") + xlab("State (short)") +
ylab("Total cases") +
scale_y_continuous(labels = human_numbers)
plot_grid(cp100k, ct, labels="")
plot(dfc$LAN_ew_EWZ, dfc$Fallzahl)
plot_grid(cp100k, ct, labels="")
